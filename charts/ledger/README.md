# Ledger helm chart

## TL;DR;

```console
helm repo add stenic https://stenic.github.io/helm-charts
helm install my-release stenic/ledger
```


## Introduction

This chart bootstraps a [Ledger](https://github.com/stenic/ledger) deployment on a [Kubernetes](http://kubernetes.io) cluster using the [Helm](https://helm.sh) package manager.


## Prerequisites

- Kubernetes 1.12+
- Helm 2.11+ or Helm 3.0+
- PV provisioner support in the underlying infrastructure
- ReadWriteMany volumes for deployment scaling


## Installing the Chart

To install the chart with the release name `my-release`:

```console
helm repo add stenic https://stenic.github.io/helm-charts
helm install my-release stenic/ledger
```

These commands deploy Ledger on the Kubernetes cluster in the default configuration. The [Parameters](#parameters) section lists the parameters that can be configured during installation.

> **Tip**: List all releases using `helm list`


## Uninstalling the Chart

To uninstall/delete the `my-release` deployment:

```console
helm delete my-release
```

The command removes all the Kubernetes components associated with the chart and deletes the release.


## Configuration

The following tables list the configurable parameters of the Ledger chart and their default values.

| Parameter                         | Description                          | Default                                   |
| --------------------------------- | ------------------------------------ | ----------------------------------------- |
| `ledger.adminPassword`            | Admin password to set in the secret  | Random value                              |
| `image.repository`                | Image name                           | `stenicbv/ledger`                         |
| `image.tag`                       | Image tag                            | Not set `Chart.AppVersion`                |
| `image.pullPolicy`                | Image pull policy                    | `IfNotPresent`                            |
| `nameOverride`                    | Override the resource name prefix    | `ledger`                                  |
| `fullnameOverride`                | Override the full resource names     | `ledger-{release-name}`                   |
| `persistence.enabled`             | Enable the use of a PVC              | `true`                                    |
| `persistence.existingClaim`       | Provide the name of a PVC            | `nil`                                     |
| `persistence.storageClass`        | Storage class for the PVC            | `nil`                                     |
| `persistence.annotations`         | Annotations for the PVC              | `{}`                                      |
| `persistence.accessMode`          | The PVC access mode                  | `ReadWriteOnce`                           |
| `persistence.size`                | The size of the PVC                  | `8Gi`                                     |
| `serviceAccount.create`           | Configures if a ServiceAccount with this name should be created | `true`         |
| `serviceAccount.annotations`      | Configures annotation for the ServiceAccount | `{}`                              |
| `serviceAccountAgent.name`        | Name of the agent ServiceAccount to be used by access-controlled resources | autogenerated |
| `statefulset.volume.name`         | Name of the volume                   | `ledger`                                  |
| `statefulset.volume.path`         | Path to mount the volume             | `/data`                                   |
| `service.type`                    | Kubernetes service type              | `ClusterIP`                               |
| `service.port`                    | Kubernetes service port              | `80`                                      |
| `ingress.enabled`                 | Enables ingress                      | `false`                                   |
| `ingress.hostName`                | Ingress host name                    | `ledger.example.com`                      |
| `ingress.annotations`             | Ingress annotations                  | `{}`                                      |
| `ingress.tls`                     | Ingress TLS configuration            | `nil`                                     |
| `resources`                       | Resources allocation (Requests and Limits) | `{requests: {cpu: 50m, memory: 28Mi}, limits: {cpu: 100m, memory: 64Mi}}`|
| `nodeSelector`                    | Node labels for pod assignment       | `{}`                                      |
| `tolerations`                     | Toleration labels for pod assignment | `[]`                                      |
| `affinity`                        | Affinity settings                    | `{}`                                      |
| `imagePullSecretName`             | Agent image pull secret              | `nil`                                     |
| `securityContext`                 | SecurityContext for Ledger           | `{}`                                      |
| `podSecurityContext`              | SecurityContext for tje Ledger pod   | `{}`                                      |

Specify each parameter using the `--set key=value[,key=value]` argument to `helm install`.

Alternatively, a YAML file that specifies the values for the parameters can be provided while installing the chart. For example,

```console
helm install my-release -f values.yaml stenic/ledger
```
